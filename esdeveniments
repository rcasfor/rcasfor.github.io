import React, { useState } from 'react';

// Dades dels esdeveniments
const eventsData = [
  {
    name: "Jam de Swing a Altafulla",
    dateTime: "Divendres, 1 d'agost, 20:00 - 22:30",
    location: "Club Mar√≠tim Altafulla",
    price: "Gratu√Øt",
    type: "Swing Jam",
    imageUrl: "https://rcasfor.github.io/maritim.jpg",
    description: "Com cada divendres es fa la ballada de swing al Maritim d'Altafulla.\nConsumici√≥ m√≠nima obligat√≤ria"
  },
  {
    name: "Jam de Swing a Altafulla",
    dateTime: "Divendres, 8 d'agost, 20:00 - 22:31",
    location: "Club Mar√≠tim Altafulla",
    price: "Gratu√Øt",
    type: "Swing Jam",
    imageUrl: "https://rcasfor.github.io/maritim.jpg",
    description: "Com cada divendres es fa la ballada de swing al Maritim d'Altafulla.\nConsumici√≥ m√≠nima obligat√≤ria"
  },
  {
    name: "Jam de Swing a Altafulla",
    dateTime: "Divendres, 15 d'agost, 20:00 - 22:30",
    location: "Club Mar√≠tim Altafulla",
    price: "Gratu√Øt",
    type: "Swing Jam",
    imageUrl: "https://rcasfor.github.io/maritim.jpg",
    description: "Com cada divendres es fa la ballada de swing al Maritim d'Altafulla.\nConsumici√≥ m√≠nima obligat√≤ria"
  },
  {
    name: "Jam de Swing a Altafulla",
    dateTime: "Divendres, 22 d'agost, 20:00 - 22:33",
    location: "Club Mar√≠tim Altafulla",
    price: "Gratu√Øt",
    type: "Swing Jam",
    imageUrl: "https://rcasfor.github.io/maritim.jpg",
    description: "Com cada divendres es fa la ballada de swing al Maritim d'Altafulla.\nConsumici√≥ m√≠nima obligat√≤ria"
  },
  {
    name: "Jam de Swing a Altafulla",
    dateTime: "Divendres, 29 d'agost, 20:00 - 22:34",
    location: "Club Mar√≠tim Altafulla",
    price: "Gratu√Øt",
    type: "Swing Jam",
    imageUrl: "https://rcasfor.github.io/maritim.jpg",
    description: "Com cada divendres es fa la ballada de swing al Maritim d'Altafulla.\nConsumici√≥ m√≠nima obligat√≤ria"
  },
  {
    name: "Festa Major de Constant√≠",
    dateTime: "Divendres, 1 d'agost, 23:00 - 01:00",
    location: "Ajuntament de Constant√≠",
    price: "Gratu√Øt",
    type: "Festa",
    imageUrl: "https://rcasfor.github.io/festa%20major%20constanti.png",
    description: "Que comenci la festa!\n\nAquest divendres 1 d'agost, la Festa Major de Constant√≠ et convida a una nit inoblidable. Est√†s preparat/da per ballar?\nA partir de les 23 h, l'orquestra Saturno ser√† l'encarregada de posar la banda sonora a una nit de m√∫sica i diversi√≥. Ens trobarem just davant de l'Ajuntament de Constant√≠.\nVolem que t'uneixis a nosaltres per gaudir d'una nit d'estiu amb la millor m√∫sica, bona companyia i l'ambient inigualable de la Festa Major. T'ho perdr√†s?"
  },
  {
    name: "Vespes & Swing",
    dateTime: "Dissabte, 9 d'agost, 12:30 - 15:30",
    location: "Picamoixons",
    price: "Gratu√Øt",
    type: "Swing",
    imageUrl: "https://rcasfor.github.io/vespes%20&%20swing.jpg",
    description: "üéâDissabte 9 d‚ÄôAgost a Picamoixons\n\n12:30-Classe oberta de Lindy Hop\n13:00-Jam amb la banda The Walking Bounce SwingüíÉ\n\nüç¥Dinar 10‚Ç¨\nVermut + Entrep√† de llonganissa a la brasa i beguda ( vi, aigua i gaseosa)\nüìû Reserva per dinar al 626731751 Imprescindible\nData l√≠mit reserves 5 d‚Äôagost\n\nüëâ Local social de Picamoixons: C/ Sant Isidre, n.3\n\nüõµ Podreu gaudir de l‚Äôexposici√≥ de Vespes dels companys moteros que participen a la 1a Trobada Vespera de Picamoixons"
  },
  {
    name: "Taller gratu√Øt de Lindy Hop Ohana Fest (Gat√≥s)",
    dateTime: "Dissabte, 9 d'agost, 18:00 - 19:30",
    location: "Gar√≥s",
    price: "Gratu√Øt",
    type: "Swing Jam",
    imageUrl: "https://rcasfor.github.io/ohana%20fest.jpg",
    description: "Lindy Hop a la Vall d'Aran: Mou-te a Gar√≤s!\n\nAquest divendres 9 d'agost, el festival Ohana Fest et porta una proposta irresistible: un taller de Lindy Hop per a tots els p√∫blics a la bonica localitat de Gar√≤s, a la Vall d'Aran.\nViu la m√†gia d'aprendre els passos d'aquest ball hist√≤ric en un entorn id√≠l¬∑lic: la Pla√ßa Major de Gar√≤s, un dels pobles m√©s singulars de la vall, amb les seves cases de pedra i la seva arquitectura tradicional que respira hist√≤ria i tranquil¬∑litat.\nNo cal que tinguis experi√®ncia pr√®via, nom√©s ganes de passar-t'ho b√©! Uneix-te a nosaltres a les 18 h i deixa't portar pel ritme. Ser√† una tarda fant√†stica per connectar amb la m√∫sica, la gent i l'encant de la Vall d'Aran.\nNo t'ho perdis! T'esperem a la pla√ßa per ballar junts."
  },
  {
    name: "Jam de Swing a Senan",
    dateTime: "Divendres, 15 d'agost, 22:30 - 23:55",
    location: "Senan",
    price: "Gratu√Øt",
    type: "Swing Jam",
    imageUrl: "https://rcasfor.github.io/logo%20BASIC%20.jpg",
    description: "Jam de Ball a Senan: Vine a Moure l'Esquelet!\n\nAquest 15 d'agost, la Conca de Barber√† et convida a una nit m√†gica. Vine a la primera Jam de ball que celebrem a Senan, un poble amb unes vistes espectaculars i envoltat d'un patrimoni hist√≤ric i cultural incre√Øble.\nBallarem a la Pla√ßa Antoni Salt√≥, just darrere de l'Ajuntament. L'energia la posar√† el nostre DJ, que far√† sonar la millor m√∫sica per a tots els gustos.\nApunta't la data i l'hora: a les 22.30 h. No hi ha millor manera de gaudir de la nit d'estiu que ballant a l'aire lliure, fent nous amics i deixant-te portar per la m√∫sica.\nT'esperem per viure una nit inoblidable! No t'ho perdis!"
  }
];

// Component per a la targeta d'esdeveniment
const EventCard = ({ event, onClick }) => {
  return (
    <div
      className="bg-gray-800 rounded-lg shadow-lg p-4 mb-4 cursor-pointer transform transition duration-300 hover:scale-105 hover:shadow-xl flex items-center space-x-4"
      onClick={() => onClick(event)}
    >
      <img
        src={event.imageUrl}
        alt={event.name}
        className="w-24 h-24 rounded-full object-cover border-2 border-indigo-500 flex-shrink-0"
        onError={(e) => { e.target.onerror = null; e.target.src = "https://placehold.co/96x96/6366f1/ffffff?text=Event"; }} // Fallback image
      />
      <div className="flex-grow">
        <h3 className="text-xl font-semibold text-white mb-1">{event.name}</h3>
        <p className="text-indigo-300 text-sm">{event.dateTime}</p>
        <p className="text-gray-400 text-sm">{event.location}</p>
        <div className="flex items-center mt-2">
          <span className="bg-indigo-600 text-white text-xs font-bold px-3 py-1 rounded-full mr-2">
            {event.price}
          </span>
          <span className="bg-gray-700 text-gray-300 text-xs font-medium px-3 py-1 rounded-full">
            {event.type}
          </span>
        </div>
      </div>
    </div>
  );
};

// Component per al detall de l'esdeveniment
const EventDetailModal = ({ event, onClose }) => {
  if (!event) return null;

  return (
    <div className="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50">
      {/* Aplicat max-h-[90vh] i overflow-y-auto al contenidor principal del modal */}
      <div className="bg-gray-900 rounded-lg shadow-2xl max-w-2xl w-full p-6 relative border border-indigo-700 max-h-[90vh] overflow-y-auto">
        <button
          className="absolute top-3 right-3 text-gray-400 hover:text-white text-2xl font-bold"
          onClick={onClose}
        >
          &times;
        </button>
        <img
          src={event.imageUrl}
          alt={event.name}
          className="w-40 h-40 rounded-full object-cover mx-auto mb-6 border-4 border-indigo-500"
          onError={(e) => { e.target.onerror = null; e.target.src = "https://placehold.co/160x160/6366f1/ffffff?text=Event"; }} // Fallback image
        />
        <h2 className="text-3xl font-extrabold text-white text-center mb-3">{event.name}</h2>
        <p className="text-indigo-400 text-lg text-center mb-4">{event.dateTime}</p>
        {/* El contingut ara s'ajustar√† i el modal sencer far√† scroll si cal */}
        <div className="text-gray-300 space-y-3 pr-2">
          <p><strong>Lloc:</strong> {event.location}</p>
          <p><strong>Entrada:</strong> {event.price}</p>
          <p><strong>Tipus:</strong> {event.type}</p>
          <p className="whitespace-pre-wrap">{event.description}</p>
        </div>
      </div>
    </div>
  );
};

// Component principal de l'aplicaci√≥
const App = () => {
  const [selectedEvent, setSelectedEvent] = useState(null);

  // Agrupa els esdeveniments per dia per a una millor visualitzaci√≥
  const eventsGroupedByDay = eventsData.reduce((acc, event) => {
    const date = event.dateTime.split(',')[1].trim().split(' ')[0]; // Extreu el dia (ex: "1", "8")
    if (!acc[date]) {
      acc[date] = [];
    }
    acc[date].push(event);
    return acc;
  }, {});

  // Ordena els dies
  const sortedDays = Object.keys(eventsGroupedByDay).sort((a, b) => parseInt(a) - parseInt(b));

  return (
    <div className="min-h-screen bg-gray-900 font-sans text-gray-100 p-4 sm:p-8">
      <div className="max-w-3xl mx-auto">
        <header className="flex items-center mb-8">
          <span className="text-indigo-400 text-4xl mr-4">&#x1F4C5;</span> {/* Calendar icon */}
          <h1 className="text-5xl font-extrabold text-white">Esdeveniments d'estiu</h1>
        </header>

        <div className="mb-8">
          <button className="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-6 rounded-full shadow-lg transform transition duration-300 hover:scale-105">
            Agost 2025
          </button>
        </div>

        <div className="space-y-6">
          {sortedDays.map(day => (
            <div key={day}>
              <h2 className="text-4xl font-bold text-indigo-400 mb-4 ml-2">{day}</h2>
              <div className="space-y-4">
                {eventsGroupedByDay[day].map((event, index) => (
                  <EventCard key={index} event={event} onClick={setSelectedEvent} />
                ))}
              </div>
            </div>
          ))}
        </div>
      </div>

      <EventDetailModal event={selectedEvent} onClose={() => setSelectedEvent(null)} />
    </div>
  );
};

export default App;
