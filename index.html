<p>Valor mostrat: <code>window.addEventListener('message', function(event)</code></p>
<div id="received-message-display" style="margin-top: 10px; padding: 10px; border: 1px solid #ccc; background-color: #f9f9f9; font-family: monospace; white-space: pre-wrap; word-break: break-all; border-radius: 4px;">
    Esperant missatges de l'iframe...
</div>
<iframe
    id="my-calendar-iframe"
    src="https://rcasfor.github.io/"
    width="100%"
    frameborder="0"
    allowfullscreen
    style="border: none; border-radius: 8px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); height: 800px;" /* Initial height, will be overridden by JS */
>
</iframe>

<script>
    const receivedMessageDisplay = document.getElementById('received-message-display');

    // Listen for messages from the iframe
    window.addEventListener('message', function(event) {
        // IMPORTANT: For security, verify the origin of the message
        // if (event.origin !== "https://rcasfor.github.io") {
        //     return; // Discard messages from untrusted origins
        // }

        // --- AFEGIT PER DEPURACIÓ: Registra tots els missatges rebuts ---
        console.log('Missatge rebut al pare:', event);
        // ---------------------------------------------------------------

        // Check if the message contains height information and it's a valid number
        if (event.data && typeof event.data.height === 'number' && !isNaN(event.data.height)) {
            const iframe = document.getElementById('my-calendar-iframe');
            if (iframe) {
                // Set the iframe's height to the received height
                iframe.style.height = event.data.height + 'px';
            }
            // Display only the height value in pixels
            receivedMessageDisplay.textContent = 'Alçada del calendari: ' + event.data.height + 'px';
            // --- NOU LOG PER CONFIRMAR L'ACTUALITZACIÓ DEL DIV ---
            console.log('DIV actualitzat amb alçada:', event.data.height);
            // ------------------------------------------------------
        } else {
            // Display a message if no height data is received or data is malformed
            receivedMessageDisplay.textContent = 'Missatge rebut: (sense dades d\'alçada vàlides o propietat "height" no trobada)\nContingut del missatge: ' + JSON.stringify(event.data, null, 2);
            // --- NOU LOG PER CONFIRMAR L'ACTUALITZACIÓ DEL DIV ---
            console.log('DIV actualitzat amb missatge d\'error. Dades de l\'esdeveniment:', event.data);
            // ------------------------------------------------------
        }
    });
</script>
